<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>shell_source API documentation</title>
<meta name="description" content="python-shell-source
A python module for sourcing variables from shell scripts …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>shell_source</code></h1>
</header>
<section id="section-intro">
<h1 id="python-shell-source">python-shell-source</h1>
<p>A python module for sourcing variables from shell scripts.</p>
<h2 id="installation">Installation</h2>
<p>You can install this package with pip or conda.</p>
<pre><code class="language-sh">$ pip install shell-source
</code></pre>
<pre><code class="language-sh">$ conda install -c abrahammurciano shell-source
</code></pre>
<h2 id="documentation">Documentation</h2>
<p>The full documentation is available <a href="https://abrahammurciano.github.io/python-shell-source/shell_source">here</a></p>
<h2 id="usage">Usage</h2>
<p>This module provides a function <code><a title="shell_source.source" href="#shell_source.source">source()</a></code> which attempts to mimic the shell's source command.</p>
<p>The purpose of this function is to allow you to run a shell script which sets either environment variables or local variables, and then give you access to those variables. Normally this is not a straght-forward task, but this function achieves it by running the script in its intended shell then injecting commands to the shell to write its local variables and its environment variables to a temporary file. Finally it reads the temporary file and parses it to return to you with exactly the data you asked for.</p>
<h3 id="basic-usage">Basic Usage</h3>
<p>If you just pass a script and an interpreter you'll get back all the environment variables and local variables visible to and set by the script.</p>
<pre><code class="language-py">&gt;&gt;&gt; from shell_source import source
&gt;&gt;&gt; variables = source(&quot;path/to/script.sh&quot;, &quot;bash&quot;)
&gt;&gt;&gt; # It returns a dictionary of local and environment variables known by the script.
&gt;&gt;&gt; variables
{&quot;USER&quot;: &quot;abraham&quot;, &quot;PATH&quot;: &quot;/bin:/usr/bin&quot;, ..., &quot;foo&quot;: &quot;bar&quot;}
</code></pre>
<h3 id="requesting-specific-variables">Requesting Specific Variables</h3>
<p>If you specify the argument <code>variables</code>, then only those variables you passed will be present as keys in the returned dictionary.</p>
<pre><code class="language-py">&gt;&gt;&gt; source(&quot;path/to/script.sh&quot;, &quot;zsh&quot;, variables=(&quot;foo&quot;, &quot;bar&quot;, &quot;biz&quot;))
{&quot;foo&quot;: ..., &quot;bar&quot;: ..., &quot;biz&quot;, ...}
</code></pre>
<h3 id="ignoring-local-variables">Ignoring Local Variables</h3>
<p>If you don't want to obtain any local variables set by the script, but only want the environment variables, you can pass <code>ignore_locals=True</code>.</p>
<h3 id="passing-arguments-to-the-shell">Passing Arguments to the shell</h3>
<p>If you want to pass arguments to the shell, for example <code>-x</code> or <code>-e</code>, you can pass it directly in the <code>shell</code> argument.</p>
<pre><code class="language-py">&gt;&gt;&gt; source(&quot;path/to/script.sh&quot;, &quot;bash -x&quot;)
</code></pre>
<h3 id="passing-arguments-to-the-script">Passing Arguments to the script</h3>
<p>If you want to pass arguments to the script being sourced, you can pass them in the <code>args</code> argument.</p>
<pre><code class="language-py">&gt;&gt;&gt; source(&quot;path/to/script.sh&quot;, &quot;bash&quot;, args=(&quot;foo&quot;, &quot;bar&quot;))
</code></pre>
<h3 id="supporting-different-shells">Supporting Different Shells</h3>
<p>This module has been tested to work with <code>bash</code>, <code>zsh</code>, and <code>ksh</code> out of the box. You can use any other shell that's somewhat posix compliant, but it it doesn't work, you may have to create a class derived from the <code>Scripter</code> class to indicate to <code><a title="shell_source.source" href="#shell_source.source">source()</a></code> how to interact with the shell you want to use.</p>
<p>Some specialized implementations of <code>Scripter</code> are provided in <code><a title="shell_source.scripters" href="scripters/index.html">shell_source.scripters</a></code> for shells that are not posix compliant, such as <code>csh</code>, <code>tcsh</code> and <code>fish</code>.</p>
<p>For example, to use <code>tcsh</code> to source a script, you can use the <code>CshScripter</code> class like so:</p>
<pre><code class="language-py">&gt;&gt;&gt; source(&quot;path/to/script.csh&quot;, &quot;tcsh&quot;, scripter=CshScripter())
</code></pre>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="shell_source.scripters" href="scripters/index.html">shell_source.scripters</a></code></dt>
<dd>
<div class="desc"><p>Scripters can be passed to <code><a title="shell_source.source" href="#shell_source.source">source()</a></code> to allow it to interact with different shells …</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="shell_source.source"><code class="name flex">
<span>def <span class="ident">source</span></span>(<span>script: Union[str, pathlib.Path], shell: str = 'sh', *, args: Iterable[str] = (), variables: Collection[str] = (), ignore_locals: bool = False, scripter: <a title="shell_source.scripters.scripter.Scripter" href="scripters/scripter.html#shell_source.scripters.scripter.Scripter">Scripter</a> = &lt;shell_source.scripters.scripter.Scripter object&gt;, **subprocess_kwargs) ‑> Dict[str, str]</span>
</code></dt>
<dd>
<div class="desc"><p>Run a shell script and return its variables as a dictionary.</p>
<blockquote>
<p>NOTE: If the script defines variables with newlines in their values it is undefined behaviour, though it will not raise an exception.</p>
</blockquote>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>script</code></strong></dt>
<dd>The shell script to source. It may contain arguments, file redirections, etc so long as it is supported by the shell you give.</dd>
<dt><strong><code>shell</code></strong></dt>
<dd>The shell to use. If the shell you give is in the path it's name suffices, otherwise give the path to it. You may also pass flags, such as -x or -e. Default is "sh".</dd>
<dt><strong><code>args</code></strong></dt>
<dd>Any extra arguments to pass to the sourced script. Default is no arguments.</dd>
<dt><strong><code>variables</code></strong></dt>
<dd>The names of the variables set in the script to return. By default, all variables are returned.</dd>
<dt><strong><code>ignore_locals</code></strong></dt>
<dd>If True, no local variables set by the script are returned. Default is False.</dd>
<dt><strong><code>scripter</code></strong></dt>
<dd>An instance of Scripter that knows how to interact with the given shell. If your shell is (somewhat) posix-compliant the default should work. <code>csh</code> and <code>tcsh</code> must use <code>CshScripter</code>.</dd>
<dt><strong><code>subprocess_kwargs</code></strong></dt>
<dd>Any other keyword arguments are passed to subprocess.run. By default, check=True is passed. Also, args, input and text are not allowed.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#python-shell-source">python-shell-source</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#requesting-specific-variables">Requesting Specific Variables</a></li>
<li><a href="#ignoring-local-variables">Ignoring Local Variables</a></li>
<li><a href="#passing-arguments-to-the-shell">Passing Arguments to the shell</a></li>
<li><a href="#passing-arguments-to-the-script">Passing Arguments to the script</a></li>
<li><a href="#supporting-different-shells">Supporting Different Shells</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="shell_source.scripters" href="scripters/index.html">shell_source.scripters</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="shell_source.source" href="#shell_source.source">source</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>